#include <stdio.h>
#include <stdlib.h>

//mackey glass function
float mackey_glass(float x);

// narma10 inputs
float* narma10_inputs(int size);

// narma10 outputs
float* narma10_outputs(float* inputs, int size);

// Frobenius norm
float norm(float x);
float norm(float* x, int size);

// calculate kian's nrmse
float get_nrmse(float* y_hat, float* y, int size);

// calculate mean squared error
float get_mse(float* y_hat, float* y, int size);

// get sub-vector from specified indexes
float* get_vector_indexes(float* vector, int idx_0, int idx_1);

// read data from file
float* read_float_vector_from_file(char const* fileName, int size);


constexpr float MASK[] = {
0.1844695213843095,
-0.2308243009875388,
0.379384693045007,
0.12531862837886942,
0.31963441030186024,
0.07848475992899717,
0.026910959575573545,
-0.24754069651724442,
0.05912404963670359,
-0.18824303639848894,
0.28382345601855563,
-0.04533020315592318,
0.07454481441100602,
-0.4817039017638479,
0.13310825021828876,
0.10220874511280675,
-0.33491703431809483,
-0.084764854777307,
0.3468994795797784,
0.20542718862755072,
-0.4445575514411918,
-0.4647203853982612,
-0.4996234836585868,
0.1195894924597054,
-0.386695850100201,
0.3557372406595454,
0.3950870597718438,
-0.07954222571661018,
0.12966496168998654,
-0.3544313251253989,
-0.11683407601199969,
0.38615440701076176,
0.01212910849110238,
-0.2522832981877229,
0.10446660135388475,
-0.20789735734231363,
0.014463904385244919,
0.4957850701534463,
0.4715508283866162,
-0.2299096293720605,
0.4031173638489982,
-0.46638804519732424,
0.04910634682180093,
-0.3219207045248914,
0.11223595850808321,
-0.29202115983464594,
0.25904853971400277,
-0.09887987531930875,
0.26287452905700903,
0.4640670451490331
};

constexpr float W[] = {
-6.603760242462158,
-375.97887420654297,
-9.276952743530273,
-266.8567237854004,
425.4580078125,
661.2137622833252,
-206.8925724029541,
1272.4864540100098,
17.395394325256348,
50.57408332824707,
-714.5072937011719,
-37.87939381599426,
-6.382023572921753,
-107.54367036372423,
-492.3594055175781,
409.37791442871094,
36.312721252441406,
14.654291457496583,
-150.2114622592926,
-610.1216945648193,
-82.88774108886719,
-171.44318771362305,
991.3926095962524,
-62.271422386169434,
64.6613941192627,
144.72294402122498,
512.8984661102295,
-27.28133726119995,
9.10367202758789,
-191.64594340324402,
378.64263916015625,
188.30925464630127,
1031.890172958374,
-281.38884234428406,
262.6715679168701,
-484.01390075683594,
36.5869836807251,
-521.624098777771,
2822.2589168548584,
-547.3736209869385,
785.2117309570312,
3147.451301574707,
-142.90264892578125,
449.27632158994675,
-932.9185276031494,
174.44380950927734,
173.27429580688477,
-169.7334280014038,
-695.9745664596558,
-1074.1348266601562
};
